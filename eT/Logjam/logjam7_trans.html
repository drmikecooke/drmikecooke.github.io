<!DOCTYPE html>
<html lang="en-UK">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>eT: Logjam 7/trans</title>
  <link rel="stylesheet" media="screen" href="/eT/css/eT.css" />
  <link rel="stylesheet" media="print" href="/eT/css/eTp.css" />
  <link rel="icon" href="/images/mike.ico" type="image/ico" sizes="16x16">
  <style>
    .switch{position:relative;display:inline-block;width:60px;height:34px;}
    .switch input{opacity:0;width:0;height:0;}

    .slider{
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: red;
      transition: .4s;
    }

    .slider:before{
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background: white;
      transition: .4s;
    }

    input:checked + .slider {background:green;}
    input:checked + .slider:before {transform: translateX(26px);}

    .scaler {
      width: 2000px;
      height: 240px;
      text-align: center;
      position: relative;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      transform-origin: center center;
      background:orange;
    }

    .wrapper {position:relative;background:gray;}

    .rulespace{display:block;position:relative;background:green;}
    .rule {display:block;margin:auto;width:1050px;height:70px;}

    .glass {
      width: 100px;
      height: 160px;
      border: 2px solid black;
      background: grey;
      opacity: 0.2;
      position: absolute;
      top: 0;
      left:10px;
    }

    .zotblk {
      position: absolute;
      display: block;
      z-index: 20;
      width: 40px;
      font-size:large;
      text-align: center;
      top:-10px;
      left:480px;
    }

    .zotblk img{display:block;width:40px;}

    .run {
      display: block;
      width: 120px;
      font-size:large;
      text-align: center;
      white-space: nowrap;
      position:absolute;
      top:-10px;
      left:940px;
    }

    .run img {display:block;width:100px;margin:auto;}

    .iStrip {width:2000px;height:75px;background:transparent;}

    .nosel ::selection{background-color:transparent;color:#000;}

  </style>
</head>

<body>
  <header><span class="exponential">e<em><sup>x</sup>ponential</em></span> Times</header>
  <script src="/eT/nav.js"></script>
  <div class="pointer"><a href="/eT/Logjam/logjam6.html">◀ Previous</a></div>
  <article>
    <h4 id="rHead">Adder/subtractor</h4>

    <div class="arial nosel" style="text-align:center;padding:10px;">
      <p>
        <span id="addsub" style="font-weight:bold;">Add/subtract</span>
        <label class="switch">
          <input id="switch" type="checkbox" checked="false" onchange="changeRule()">
          <span class="slider"></span>
        </label>
        <span id="muldiv" style="font-weight:normal;">Multiply/divide</span>
      </p>
    </div>

    <div class="wrapper" id="wrapper">
      <div class="scaler nosel" id="scaler">
        <div style="height:20px"></div>
        <div class="rulespace" id="rs">
          <div id="sblk">
            <img src="images/linear.svg" alt="rule.svg" draggable="false" class="rule" id="slide" />
            <div id="zblk" class="zotblk">
              <img src="images/redline.svg" alt="redline" draggable="false">
              <div id="info"></div>
            </div>
            <div id="tblk" class="zotblk" style="left:1480px;">
              <img src="images/redline.svg" alt="redline" draggable="false">
              <div id="tinfo"></div>
            </div>
          </div>

          <img src="images/linear.svg" alt="rule.svg" draggable="false" class="rule" id="fixed" />

          <div id="rblk" class="run">
            <img src="images/runner.svg" alt="glass" draggable="false">
            <div id="add"></div>
          </div>

        </div>

        <div class="iStrip"></div>
      </div>
    </div>

    <script>
      function ruleSwitch(rh,aw,mw,r,tsd,rc,am,sd) {
        document.getElementById("rHead").innerText=rh;
        document.getElementById("addsub").style.fontWeight=aw;
        document.getElementById("muldiv").style.fontWeight=mw;
        document.getElementById("fixed").src="images/"+r+".svg";
        document.getElementById("slide").src="images/"+r+".svg";
        document.getElementById("tblk").style.display=tsd;
        rConvert= rc;
        addmul = am;
        subdiv = sd;
      }

      function changeRule() {
        if(document.getElementById("switch").checked){
          ruleSwitch("Multiply/divide","normal","bold","log","block",(x)=>Math.pow(10,x/1000)," × "," / ");
        }else{
          ruleSwitch("Add/subtract","bold","normal","linear","none",(x)=>x/50," + "," – ");
        }
        readings();
      }

      function getX(e) {
        if(e.type=="touchstart"||e.type=="touchmove") {return  e.touches[0].clientX/scale}
        return e.clientX/scale
      }

      function dragStart(e) {
        if(e.currentTarget.id=="rblk") {active=runner}else{active=slide}
        dStart=getX(e);
      }

      function drag(e) {
        if(active) {
          e.preventDefault();
          dNext = getX(e);
          active.t+=dNext-dStart;
          active.element.style.transform="translate("+active.t+"px)";
          dStart = dNext;
          readings();
        }
      }

      function dragEnd(e) {active = false;readings();}

      function readings() {
        var refzero = rConvert(slide.t);
        var reften = rConvert(slide.t+1000);
        var result = rConvert(runner.t+500);
        var run = rConvert(runner.t-slide.t+500);
        document.getElementById("info").innerHTML = refzero.toFixed(2) + "<br />" + refzero.toFixed(2);
        document.getElementById("tinfo").innerHTML = (reften).toFixed(2) + "<br />" + (reften).toFixed(2);
        document.getElementById("add").innerHTML= addmul+run.toFixed(2)+" = "+result.toFixed(2)+"<br />"+"= "+result.toFixed(2)+subdiv+run.toFixed(2);
      }

      document.getElementById("switch").checked=false;

      var slide = {element:document.getElementById("sblk"),t:0};
      var space = document.getElementById("rs");
      var active=false;
      var dStart, dNext, rConvert, addmul, subdiv;
      ruleSwitch("Add/subtract","bold","normal","linear","none",(x)=>x/50," + "," – ");
      var runner = {element:document.getElementById("rblk"),t:0}; // set up runner/glass
      readings();

      slide.element.addEventListener("touchstart", dragStart, false);
      slide.element.addEventListener("mousedown", dragStart, false);
      space.addEventListener("touchmove", drag, false);
      space.addEventListener("mousemove", drag, false);
      window.addEventListener("touchend", dragEnd, false);
      window.addEventListener("mouseup", dragEnd, false);
      runner.element.addEventListener("touchstart", dragStart, false);
      runner.element.addEventListener("mousedown", dragStart, false);

      var wrap=document.getElementById("wrapper");
      var object=document.getElementById("scaler");
      var scale=wrap.offsetWidth/object.offsetWidth;
      wrap.style.height=scale*object.offsetHeight+"px";
      object.style.transform="translate(-50%,-50%) scale("+scale+","+scale+")";
    </script>
  </body>
  </html>