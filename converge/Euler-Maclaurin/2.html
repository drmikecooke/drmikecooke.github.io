<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <link rel="stylesheet" media="screen" href="../screen.css" />
  <link rel="stylesheet" media="print" href="../print.css" />
  <title>Euler-Maclaurin</title>
  <link rel="icon" href="/images/mike.ico" type="image/ico" sizes="16x16">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <style type="text/css">
    .shrink {font-size:0.95em}
  </style>
</head>

<body>
  <header>C<span class="shrink">o<span class="shrink">n<span class="shrink">v<span class="shrink">e<span class="shrink">r<span class="shrink">g<span class="shrink">e<span class="shrink">n<span class="shrink">c<span class="shrink">e</span></span></span></span></span></span></span></span></span></span></header>
  <script src="../nav.js"></script>
<div id="prev" class="pointer"><a>◀ Previous</a></div>
  <article>
    <div id="tag" class="tag">Euler-Maclaurin</div>
<h2 id="bernoulli-extension-extended-interval">Extended interval</h2>
<p>Rather than dragging back the function of interest, we can define a periodized Bernoulli polynomial <span class="math inline">\(P_k(x)=B_k(\{x\})\)</span>, according to the fractional part of <span class="math inline">\(x\)</span>, <span class="math inline">\(\{x\}\)</span>: <span class="math display">\[\sum\limits_{n=0}^{N-1}\int\limits_n^{n+1}\frac{df}{dx}P_1(x)dx=\frac 12\sum\limits_{n=0}^{N-1}\left[f(n)+f(n+1)\right]-\int\limits_0^Nf(x)dx\]</span></p>
<p>We now want to analyze the left hand side better. We start with the integration by parts using <span class="math inline">\(P_2&#39;(x)=2P_1(x)\)</span>, but in case there are nasty suprizes like with the original integration by parts that got us this far, we keep the integrals exploded into a sum of parts over unit-length intervals for now: <span class="math display">\[\sum\limits_{n=0}^{N-1}\int\limits_n^{n+1}\frac{df}{dx}\frac{P_2&#39;(x)}2dx=\sum\limits_{n=0}^{N-1} \left[ \left[\frac{df}{dx}\frac{P_2(x)}2\right]_n^{n+1}-\int\limits_n^{n+1}\frac{d^2f}{dx^2}\frac{P_2}2dx\right]\]</span> For integer values <span class="math inline">\(P_2(n)=B_2(0)=B_2^-=1/6\)</span>. The non-integral part is thus: <span class="math display">\[\sum\limits_{n=0}^{N-1}\left[\frac{df}{dx}\frac{P_2(x)}2\right]_n^{n+1}=\frac 1{12}\sum\limits_{n=0}^{N-1}\left[\frac{df}{dx}(n+1)-\frac{df}{dx}(n)\right]\]</span> The inner parts cancel, and one is left with the surface terms: <span class="math display">\[\sum\limits_{n=0}^{N-1}\left[\frac{df}{dx}\frac{P_2(x)}2\right]_n^{n+1}=\frac 1{12}\left[\frac{df}{dx}(N)-\frac{df}{dx}(0)\right]\]</span> Therefore we can compactify the integrals: <span class="math display">\[\int\limits_0^N\frac{df}{dx}\frac{P_2&#39;(x)}2dx=\left[\frac{df}{dx}\frac{P_2(x)}2\right]_0^N-\int\limits_0^N\frac{d^2f}{dx^2}\frac{P_2}2dx\]</span></p>
<p>Combining the bits: <span class="math display">\[
\begin{aligned}
\sum\limits_{n=0}^Nf(n)=&amp;\int\limits_0^Nf(x)dx+\frac{f(0)+f(N)}2\\
&amp;+\frac1{12}\left[\frac{df}{dx}(N)-\frac{df}{dx}(0)\right]\\
&amp;-\int\limits_0^N\frac{d^2f}{dx^2}\frac{P_2}2dx
\end{aligned}
\]</span></p>
<p>If we continue integrating by parts, remembering that the odd Bernoulli numbers are zero: <span class="math display">\[
\begin{aligned}
\sum\limits_{n=0}^Nf(n)=&amp;\int\limits_0^Nf(x)dx+\frac{f(0)+f(N)}2\\
&amp;+\sum\limits_{m=0}^M\left[\frac{B_{2m}^-}{(2m)!}\left[\frac{d^{2m-1}f}{dx^{2m-1}}(N)-\frac{d^{2m-1}f}{dx^{2m-1}}(0)\right]\right]\\
&amp;-\int\limits_0^N\frac{d^{2M}f}{dx^{2M}}\frac{P_{2M}}{(2M)!}
\end{aligned}
\]</span> While useful, this expression must be treated with care since the Bernoulli numbers and polynomials become large for large <span class="math inline">\(M\)</span>.</p>
</article>
<div  id="next" class="pointer"><a class="pointright">Next ▶</a></div>
  <script src="/js/footer.js"></script>
<script src="../number.js"></script>
</body>
</html>
